# Registers 寄存器
`pattern`:  选择内容 + 寄存器 + 输入内容
    - [在视图模式下选择内容][设置指定寄存器][操作]
        ---------------select_contents_in_visual_mod---register-------------operator------------
        - `v2j"ac`  ---> `v2j` 进入试图模式并选择两行，  `"a` 设置寄存器`a` ， c 即剪切(cut)操作，剪切所选内容并进入插入模式，将剪切内容存储到寄存器`a`.
        - `"ap`：粘贴寄存器 `a` 的内容。

`pattern`: 寄存器 + (选择内容) + 输入内容
    - `register + operator`
        -------------------register----------operator-----------------------------------------
        - `"aS`：   ---> `"a` 设置寄存器`a`, `S`即删除当前行操作,删除当前行, 将删除行内容存储到寄存器 `a`。
        - `"ap`：粘贴寄存器 `a` 的内容。
    - `register + operator + motion`
        ---------------------register---------operator-----motion-----------------------------
        -`"ad^`    --->  `"a` 设置寄存器`a`, `d`即删除操作,`^`删除到行de首字母, 将删除内容存储到寄存器 `a`。
        - `"ap`：粘贴寄存器 `a` 的内容。
    - `register + operator + scoop + text-object`
        ---------------register-----------operator--- scope---text object--------------------
        - `"ayi[` --->   `"a` 设置寄存器`a`, `y`即复制操作,`i`即inner 加上`[` -> `i[` 就是[]里面的内容(不包括[]), 将删除内容存储到寄存器 `a`。
        - `"ap`：粘贴寄存器 `a` 的内容。
## overview
 - Vim 寄存器是用于存储文本片段的临时存储区域，可以保存复制（yank）、删除（delete）、剪切（cut）或其他操作的内容。
 - 寄存器类似于操作系统的剪贴板，但 Vim 的寄存器系统更灵活，支持多种类型，每种类型有不同的用途。
 - 用户可以通过特定的命令访问和操作寄存器，例如存储、粘贴或查看内容。

 ### 寄存器的核心功能
 - **存储文本**：复制、删除或剪切的文本会存储到指定的寄存器中。
 - **调用文本**：通过粘贴命令（`p` 或 `P`）从寄存器中提取内容。
 - **与其他功能结合**：寄存器可以与宏、搜索模式、系统剪贴板等功能结合使用。


 ## 寄存器的类型


 ### 未命名寄存器（Unnamed Register）
 - **表示**：`""`（双引号)
 - **用途**：
   - 默认寄存器：执行 `y`（复制）、`d`（删除）或 `c`（剪切）等操作时，内容会自动存储到未命名寄存器。
   - 粘贴时默认使用未命名寄存器的内容。
 - **操作方法**：
   - 存储：`yy`（复制当前行）、`dd`（删除当前行）。
   - 粘贴：`p`（光标后粘贴）或 `P`（光标前粘贴）。
 - **示例**：
   ```
   yy        " 复制当前行到未命名寄存器
   p         " 粘贴未命名寄存器中的内容
   ```

 ### 命名寄存器（Named Registers）
 - **表示**：`"a` 到 `"z`（小写字母）和 `"A` 到 `"Z`（大写字母），共 52 个。
 - **用途**：
   - 小写寄存器（`"a` 到 `"z`）：**覆盖存储**，替换寄存器中原有内容。
   - 大写寄存器（`"A` 到 `"Z`）：**追加存储**，将新内容追加到寄存器中。
 - **操作方法**：
   - 存储：`"[小写寄存器]y[范围]`（如 `"ayy`）。
   - 追加：`"[大写寄存器]y[范围]`（如 `"Ayy`）。
   - 粘贴：`"[寄存器]p` 或 `"[寄存器]P`。
 - **示例**：
   ```
   "ayy      " 将当前行复制到寄存器 a
   "Ayy      " 将另一行追加到寄存器 a
   "ap       " 粘贴寄存器 a 的内容
   ```
 ###  只读寄存器（Read-Only Registers）
 - **表示**：`":`、`" .` 和 `"%`。
 - **用途**：
   - `":`：存储最近执行的命令（来自命令行模式）。
   - `" .`：存储最近插入的文本（插入模式）。
   - `"%`：存储当前文件的路径。
 - **操作方法**：
   - 只读寄存器只能用于粘贴，不能写入。
   - 粘贴：`"[寄存器]p` 或 `"[寄存器]P`。
 - **示例**：
   ```
   ":p       " 粘贴最近执行的命令
   "%p       " 粘贴当前文件路径
   ```
 ###  数字寄存器（Numbered Registers）
 - **表示**：`"0` 到 `"9`。
 - **用途**：
   - `"0`：存储最近的复制操作（`y` 命令），不受删除操作影响。
   - `"1` 到 `"9`：存储最近的删除操作（`d` 或 `c`），按时间顺序排列：
     - `"1` 是最近的删除，`"2` 是上一次删除，以此类推。
     - 新删除操作会将内容向下推移（`"1` → `"2`，依次类推）。
 - **操作方法**：
   - 存储：自动存储，无需手动指定。
   - 粘贴：`"[寄存器]p` 或 `"[寄存器]P`。
 - **示例**：
   ```
   yy        " 复制一行，存储到 "0
   dd        " 删除一行，存储到 "1，之前的 "1 移到 "2
   "0p       " 粘贴最近复制的内容
   ```

 ###  小删除寄存器（Small Delete Register）
 - **表示**：`"-`。
 - **用途**：
   - 存储少于一行的小范围删除（如单个单词或字符）。
   - 如果删除的内容超过一行，则存储到数字寄存器 `"1`。
 - **操作方法**：
   - 存储：自动存储，无需手动指定。
   - 粘贴：`"-[p]` 或 `"-[P]`。
 - **示例**：
   ```
   diw       " 删除当前单词，存储到 "-
   "-p       " 粘贴删除的单词
   ```

 ###  黑洞寄存器（Black Hole Register）
 - **表示**：`"_`。
 - **用途**：
   - 用于丢弃内容，操作时不会影响其他寄存器。
   - 适合需要删除或剪切文本但不希望存储到寄存器的情况。
 - **操作方法**：
   - 存储：`"_d[范围]` 或 `"_y[范围]`。
 - **示例**：
   ```
   "_dd      " 删除当前行，但不存储到任何寄存器
   ```

 ###  系统剪贴板寄存器（System Clipboard Registers）
 - **表示**：`"+` 和 `"*`。
 - **用途**：
   - 与系统剪贴板交互，允许 Vim 和外部程序共享内容。
   - `"+`：与系统剪贴板（通常是 Ctrl+C/Ctrl+V）交互。
   - `"*`：与鼠标中键剪贴板（通常是鼠标选择）交互。
 - **操作方法**：
   - 存储：`"+y[范围]` 或 `"*y[范围]`。
   - 粘贴：`"+p` 或 `"*p`。
 - **注意**：
   - 需要 Vim 编译时支持剪贴板功能（`:echo has('clipboard')` 检查是否支持）。
   - 可以设置 `set clipboard=unnamed` 或 `set clipboard=unnamedplus`，使默认操作直接使用系统剪贴板。
 - **示例**：
   ```
   "+yy      " 复制当前行到系统剪贴板
   "+p       " 从系统剪贴板粘贴内容
   ```

 ###  表达式寄存器（Expression Register）
 - **表示**：`"=`。
 - **用途**：
   - 用于执行 Vim 脚本表达式并将结果插入到文本中。
 - **操作方法**：
   - 在插入模式下：
     1. 按 `Ctrl-r =`。
     2. 输入表达式（如 `5+3`）。
     3. 按 Enter，插入结果。
   - 在普通模式下：`"=[表达式]p`。
 - **示例**：
   ```
   " 在插入模式下：
   Ctrl-r =5+3
   " 插入结果 "8"
   ```

 ###  搜索寄存器（Search Register）
 - **表示**：`"/`。
 - **用途**：
   - 存储最近的搜索模式。
 - **操作方法**：
   - 存储：自动存储，无需手动指定。
   - 粘贴：`"/p` 或 `"/P`。
   - 修改：使用 `:let @/ = "pattern"` 修改搜索寄存器内容。
 - **示例**：
   ```
   /hello    " 搜索 "hello"，存储到 "/
   "/p       " 粘贴搜索模式 "hello"
   ```

 ###  选择寄存器（Selection Registers）
 - **表示**：`"~`、`"*` 和 `"+`。
 - **用途**：
   - 在可视模式下选择文本时使用，与系统剪贴板寄存器类似。
 - **操作方法**：
   - 存储：在可视模式下选择文本后，使用 `"[寄存器]y`。
   - 粘贴：`"[寄存器]p` 或 `"[寄存器]P`。
 - **示例**：
   ```
   V         " 进入可视模式
   "+y       " 复制选中文本到系统剪贴板
   ```

 ---

 ## 三、查看寄存器内容

 ###  使用 `:reg` 命令
 - **查看所有寄存器**：
   - 命令：`:reg`。
   - 列出所有非空寄存器的内容。
 - **查看指定寄存器**：
   - 命令：`:reg [寄存器列表]`。
   - 示例：`:reg a b c`（查看寄存器 `a`、`b` 和 `c` 的内容）。
 - **输出格式**：
   ```
   :reg
   --- Registers ---
   ""   Hello World
   "0   First line
   "1   Second line
   ```

 ###  使用 Vim 脚本查看
 - 使用 `getreg()` 函数查看寄存器内容：
   ```
   :echo getreg('a')  " 查看寄存器 a 的内容
   ```

 ## 寄存器的操作方法

 ###  存储到寄存器
 - **普通模式下**：
   - 复制：`"[寄存器]y[范围]`（如 `"ayy`）。
   - 删除：`"[寄存器]d[范围]`（如 `"add`）。
   - 剪切：`"[寄存器]c[范围]`（如 `"aciw`）。
 - **可视模式下**：
   - 选择文本后，使用 `"[寄存器]y` 或 `"[寄存器]d`。

 ### 粘贴寄存器内容
 - **普通模式下**：
   - 光标后粘贴：`"[寄存器]p`。
   - 光标前粘贴：`"[寄存器]P`。
 - **插入模式下**：
   - 按 `Ctrl-r [寄存器]`，直接插入寄存器内容。
   - 示例：`Ctrl-r a`（插入寄存器 `a` 的内容）。

 ### 追加到寄存器
 - 使用大写寄存器进行追加：
   - 示例：`"Ayy`（将当前行追加到寄存器 `a`）。

 ### 清空寄存器
 - 使用 `:let` 命令清空寄存器：
   - 示例：`:let @a = ""`（清空寄存器 `a`）。

 ---

 ## 实用技巧

 ###  快速访问系统剪贴板
 - 设置 `set clipboard=unnamed` 或 `set clipboard=unnamedplus`，使默认操作直接使用系统剪贴板：
   - `unnamed`：与 `"*` 寄存器同步（鼠标中键剪贴板）。
   - `unnamedplus`：与 `"+` 寄存器同步（系统剪贴板）。

 ###  宏与寄存器结合
 - 宏可以存储到命名寄存器中：
   - 录制宏：`qa[操作]q`（录制到寄存器 `a`）。
   - 执行宏：`@a`。
 - 示例：
   ```
   qa        " 开始录制宏到寄存器 a
   iHello<Esc>  " 插入 "Hello" 并退出插入模式
   q         " 停止录制
   @a        " 执行宏
   ```

 ###  批量操作寄存器
 - 使用 Vim 脚本批量操作寄存器：
   ```
   :let @a = @b . @c  " 将寄存器 b 和 c 的内容合并到 a
   ```

 ### 避免覆盖寄存器
 - 删除或剪切时使用黑洞寄存器 `"_`，避免覆盖其他寄存器：
   ```
   "_dd      " 删除当前行，不存储到任何寄存器
   ```

 ### 跨会话持久化寄存器
 - 默认情况下，寄存器内容在 Vim 会话结束后会丢失。
 - 可以通过以下方法持久化：
   - **手动保存到文件**：
     ```
     :call writefile([getreg('a')], 'reg_a.txt')
     ```
   - **手动读取文件**：
     ```
     :let @a = readfile('reg_a.txt')[0]
     ```
   - **使用插件**：如 `vim-session` 或 `vim-persist寄存器`。

 ### 寄存器与可视模式结合
 - 在可视模式下选择文本后，可以直接存储到寄存器：
   ```
   V"ay      " 选择文本并复制到寄存器 a
   ```

 ---

 ## 注意事项

 ###  寄存器内容非持久化
 - 寄存器内容在 Vim 会话结束后会丢失，除非手动保存或使用插件。

 ###  系统剪贴板支持
 - 系统剪贴板寄存器（`"+` 和 `"*`）需要 Vim 支持剪贴板功能：
   - 检查支持：`:echo has('clipboard')`。
   - 如果不支持，可以安装支持剪贴板的 Vim 版本（如 `vim-gtk` 或 `vim-athena`）。

 ###  大小写敏感
 - 寄存器名称对大小写敏感，例如 `"a` 和 `"A` 是不同的寄存器。

 ###  多行文本的处理
 - 寄存器内容可能是多行文本，粘贴时可能需要调整格式：
   - 使用 `:set paste` 避免自动缩进。
   - 使用 `]p` 或 `[p` 调整缩进。

 ---

 ## 进阶用法

 ### 与 Vim 脚本结合
 - 使用 `getreg()` 和 `setreg()` 函数操作寄存器：
   ```
   :echo getreg('a')        " 查看寄存器 a 的内容
   :call setreg('a', 'text') " 设置寄存器 a 的内容为 'text'
   ```

 ### 与外部工具交互
 - 使用 `:!` 命令将寄存器内容传递给外部工具：
   ```
   :!echo <C-r>a | grep pattern
   ```

 ###  寄存器与搜索模式结合
 - 使用搜索寄存器 `"/` 存储复杂的搜索模式：
   ```
   :let @/ = '\<word\>'  " 设置搜索模式为精确匹配 "word"
   n                      " 跳转到下一个匹配
   ```

 ### 寄存器与表达式结合
 - 使用表达式寄存器 `"=` 执行动态计算：
   ```
   " 在插入模式下：
   Ctrl-r =strftime('%Y-%m-%d')
   " 插入当前日期
   ```
