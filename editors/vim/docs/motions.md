# Motions 移动

## 基本移动
- **定义**：用于方向和单词级别的光标移动。
- **方向移动**：
  - `h`（左移，left）。
  - `j`（下移，down）。
  - `k`（上移，up）。
  - `l`（右移，right）。
  - **计数支持**：如 `10j` 向下移动 10 行。
  - **示例**：按 `5h` 向左移动 5 个字符。
- **单词移动**：
  - `w` 跳到下一个单词开头，word
  - `W` 跳到下一个大单词开头，忽略符号，word
  - `b` 跳到上一个单词开头，back
  - `B` 跳到上一个大单词开头, back
  - `e` 跳到当前单词结尾，end
  - `E` 跳到当前大单词结尾，end
  - **计数支持**：如 `3w` 向前跳 3 个单词。
  - **示例**：按 `2W` 跳到下下个大单词开头。
- **注意事项**：
  - 小写命令（如 `w`）以标点分隔单词，大写命令（如 `W`）以空格分隔。
  - 单词移动适合快速定位，结合 Operators 使用更高效。

## 行内移动
- **定义**：用于在当前行内移动光标。
- **命令**：
  - `0`（跳到行首，zero）。
  - `$`（跳到行尾，end of line）。
  - `^`（跳到行首第一个非空白字符，first non-blank）。
  - `g_`（跳到行尾最后一个非空白字符）。
  - **计数支持**：如 `2$` 跳到下第 2 行的行尾。
- **示例**：
  - 按 `0` 跳到行首，然后按 `$` 跳到行尾。
  - 按 `^` 跳到行首第一个非空白字符。
- **注意事项**：
  - `0` 和 `^` 的区别：`0` 是绝对行首，`^` 忽略前导空白。
  - `g_` 适合处理行尾有空格的情况。

## 跨行移动
- **定义**：用于在文件内跨行移动光标。
- **命令**：
  - `gg`（跳到文件开头，go to top）。
  - `G`（跳到文件结尾，go to bottom）。
  - `:<num>`（跳到指定行号，例如 `:10` 跳到第 10 行）。
  - `H`（跳到屏幕顶部，high）。
  - `M`（跳到屏幕中间，middle）。
  - `L`（跳到屏幕底部，low）。
  - **计数支持**：如 `5G` 跳到第 5 行。
- **示例**：
  - 按 `gg` 跳到文件开头，然后按 `G` 跳到文件结尾。
- **注意事项**：
  - `H`、`M`、`L` 是屏幕相对位置，适合快速定位。
  - 使用 `:<num>` 跳转到具体行号，适合大文件。

## 滚动
- `Ctrl-d` 向下滚动半屏，down
- `Ctrl-u` 向上滚动半屏，up
- `Ctrl-f` 向下滚动一屏，forward
- `Ctrl-b` 向上滚动一屏，backward
- `zz`：当前行居中显示,光标保持在当前行。
- `zt`：将当前行移到屏幕顶部，光标保持在当前行。
- `zb`：将当前行移到屏幕底部，光标保持在当前行。

##  搜索移动
- **命令**：
  - **字符搜索**：
    - `f{char}`：向前搜索指定字符（如 `fa` 搜索下一个 `a`），按 `n` 重复此操作，`N` 反向操作。
    - `F{char}`：向后搜索指定字符（如 `Fa` 搜索上一个 `a`），按 `n` 重复此操作，`N` 反向操作。
    - `t{char}`：向前搜索指定字符并停在字符前（如 `ta` 停在下一个 `a` 前），按 `n` 重复，`N` 反向。
    - `T{char}`：向后搜索指定字符并停在字符前（如 `Ta` 停在上一个 `a` 前），按 `n` 重复，`N` 反向。
  - **模式搜索**：
    - `/pattern`：向前搜索模式（如 `/foo` 搜索 `foo`），按 `n` 重复此操作，`N` 反向操作。
    - `?pattern`：向后搜索模式（如 `?foo` 搜索 `foo`），按 `n` 重复此操作，`N` 反向操作。
  - **单词搜索**：
    - `*`：向前搜索光标下的单词，按 `n` 重复，`N` 反向。
    - `#`：向后搜索光标下的单词，按 `n` 重复，`N` 反向。
  - **行为细节**：
    - **字符搜索**：
      - `f` 和 `F` 在当前行内搜索，定位到目标字符。
      - `t` 和 `T` 在当前行内搜索，定位到目标字符前一个位置。
      - 支持多字节字符，正确处理 Unicode 字符。
    - **模式搜索**：
      - `/` 和 `?` 在整个文件中搜索，支持正则表达式和高亮显示。
      - 使用 `:set hlsearch` 高亮搜索结果，`:noh` 或 `:nohlsearch` 取消高亮。
      - 支持大小写敏感（由 `set ignorecase` 和 `set smartcase` 控制）。
    - **单词搜索**：
      - `*` 和 `#` 基于 `iskeyword` 设置，自动匹配完整单词。
      - 支持多字节字符，正确处理 Unicode 单词。
    - **边界处理**：
      - 在行首或行尾，字符搜索会停在边界，不会跨行。
      - 在文件开头或结尾，模式搜索和单词搜索会循环（由 `set wrapscan` 控制）。



## 标记移动

- **定义**：
  - 标记移动命令通过设置和跳转标记快速定位光标位置，提供快速导航功能。
  - 标记支持本地（小写字母）和全局（大写字母），适合处理当前文件和多文件场景。

- **命令**：
  - `m{a-zA-Z}`：在当前光标位置设置标记（如 `ma` 设置标记 `a`）。
  - `'a`：跳到标记 `a` 所在的行（jump to mark a），定位到行首非空白字符。
  - ``a`：跳到标记 `a` 的精确位置（行和列）。
  - `:marks`：查看所有标记，包括本地标记（`a-z`）、全局标记（`A-Z`）和特殊标记。
  - `:delmarks {mark}`：删除指定标记（如 `:delmarks a` 删除标记 `a`）。
  - `:delmarks!`：删除所有标记。
  - **行为细节**：
    - **标记类型**：
      - 小写标记（`a-z`）仅在当前 buffer 有效，关闭 buffer 后丢失。
      - 大写标记（`A-Z`）在全局有效，关闭 Vim 后保存在 `~/.viminfo` 文件中（Neovim 使用 `~/.local/share/nvim/shada`）。
    - **跳转方式**：
      - `'a` 定位到标记所在行的第一个非空白字符，适合行级操作。
      - ``a` 定位到标记的精确位置（行和列），适合精确导航。
    - **特殊标记**：
      - ```：跳转到上次跳转前的位置。
      - `'：跳转到上次编辑的位置。
      - `.：跳转到上次修改的位置。
    - **边界处理**：
      - 如果标记所在行被删除，跳转可能会失败或定位到最近的有效行。
      - 在文件开头或结尾，标记跳转会停在边界，不会越界。
  - **示例**：
    - 按 `ma` 设置标记 `a`，移动到其他位置后，按 `'a` 跳回标记所在的行。
    - 按 ``a` 跳到标记 `a` 的精确列，适用于精确导航。
    - 按 `:marks` 查看所有标记，检查标记状态。
  - **注意事项**：
    - 标记名称区分大小写，`a` 和 `A` 是不同的标记，小写标记仅限于当前 buffer。
    - 如果标记所在行被删除，跳转可能会失败，检查 `:marks` 输出确认标记状态。
    - 在大文件中，标记跳转性能高效，适合快速定位，但频繁跳转可能触发屏幕重绘。
    - 在使用全局标记（`A-Z`）时，注意文件路径是否正确，避免跳转失败。
  - **场景应用**：
    - **代码编辑**：使用 `ma` 和 `'a` 在函数间快速跳转，修改代码。
    - **文本编辑**：使用 `mA` 和 ``A` 在多文件中标记关键位置，快速切换。
    - **调试**：使用特殊标记（如 `.）跳转到上次修改位置，检查错误。
  - **高级用法**：
    - **与操作符结合**：
      - 示例：`d'a` 删除到标记 `a` 的行，`y`a` 复制到标记 `a` 的精确位置。
      - 场景：使用 `c'A` 替换到全局标记 `A`，快速修改多文件内容。
    - **与可视模式结合**：
      - 示例：进入可视模式（`v`），使用 `'a` 或 ``a` 扩展选择范围。
      - 场景：使用 `v'a` 选择到标记 `a` 的行，批量注释代码。
    - **与寄存器结合**：
      - 跳转到标记后使用 `"ayy` 复制当前行到寄存器 `a`。
      - 场景：按 ``A` 跳转到全局标记 `A`，然后按 `"byy` 复制当前行到寄存器 `b`。
    - **与宏结合**：
      - 示例：录制宏 `qama'dq`，设置标记 `a` 并删除，重复执行以清理多行。
      - 场景：使用宏 `qa'Aydq`，跳转到全局标记 `A` 并复制，批量处理重复模式。
    - **与相对行号结合**：
      - 启用相对行号（`:set relativenumber`），结合 `'a` 和 ``a` 快速定位。
      - 示例：按 `'a` 跳到标记 `a` 的行，相对行号提供上下文参考。
    - **自定义映射**：
      - 在 `.vimrc` 中定义映射，如 `nnoremap <leader>ma ma`（`<leader>ma` 设置标记 `a`）。
      - 示例：`nnoremap <C-m> 'a`（`Ctrl + m` 跳到标记 `a` 的行）。
      - 场景：使用 `nnoremap <leader>`a :execute "normal! `a"<CR>`，动态执行跳到标记 `a` 的精确位置。
  - **性能优化**：
    - 禁用不必要的设置，如 `:set nocursorline`，减少屏幕重绘开销。
    - 在大文件中，使用 `:set lazyredraw`，延迟屏幕重绘，提高跳转性能。
    - 示例：`autocmd BufReadPost * if line('$') > 1000 | set lazyredraw | endif`，在大文件中启用延迟重绘。

## 其他移动

- **定义**：
  - 其他移动命令用于特殊场景的导航，如括号匹配、代码块跳转、句子和段落移动，提供智能导航功能。
  - 这些命令适合处理结构化文本和代码，适用于代码编辑、文档浏览和调试场景。

- **命令**：
  - `%`：在匹配的括号、代码块之间跳转（如 `()`、`{}`、`[]`）。
  - `[{`：跳到上一个大括号 `{` 的开头（previous brace）。
  - `]}`：跳到下一个大括号 `}` 的开头（next brace）。
  - `(`：跳到上一个句子的开头（previous sentence）。
  - `)`：跳到下一个句子的开头（next sentence）。
  - `{`：跳到上一个段落的开头（previous paragraph）。
  - `}`：跳到下一个段落的开头（next paragraph）。
  - **行为细节**：
    - **括号匹配**：
      - `%` 支持多种括号类型，依赖于 `matchpairs` 设置（如 `:set matchpairs?`）。
      - 支持多字节字符，正确处理 Unicode 括号。
    - **代码块跳转**：
      - `[{` 和 `]}` 适合处理代码块，自动定位到 `{` 或 `}` 的开头。
      - 支持嵌套代码块，跳转到最外层的匹配括号。
    - **句子移动**：
      - `(` 和 `)` 基于句子的定义（由 `.`、`!`、`?` 分隔），适合处理自然语言文本。
      - 支持多字节字符，正确处理 Unicode 句子。
    - **段落移动**：
      - `{` 和 `}` 基于段落的定义（由空行分隔），适合处理结构化文档。
      - 支持多字节字符，正确处理 Unicode 段落。
    - **边界处理**：
      - 在文件开头或结尾，跳转会停在边界，不会越界。
      - 在空文件或单行文件中，句子和段落移动会停在当前行。
  - **示例**：
    - 光标在 `)` 上，按 `%` 跳到匹配的 `(`，适用于代码导航。
    - 按 `[{` 跳到上一个 `{`，然后按 `]}` 跳到下一个 `}`，适用于定位函数定义。
    - 按 `)` 跳到下一个句子的开头，适用于文档编辑。
  - **注意事项**：
    - `%` 的行为依赖于括号匹配插件（如 `matchit.vim`），启用后支持更多匹配类型（如 HTML 标签）。
    - 在大文件中，括号跳转可能受性能影响，优化 `matchpairs` 设置。
    - 句子和段落的定义依赖于 Vim 的 `paragraphs` 和 `sections` 设置，检查 `:set paragraphs?` 输出。
    - 如果跳转行为不符合预期，检查是否启用了插件（如 `vim-surround`）或设置（如 `set matchpairs`）。
  - **场景应用**：
    - **代码编辑**：使用 `%` 在括号间跳转，快速修改嵌套代码。
    - **文本编辑**：使用 `(` 和 `)` 在句子间移动，快速编辑文档。
    - **调试**：使用 `[{` 和 `]}` 定位函数定义，检查代码结构。
  - **高级用法**：
    - **与操作符结合**：
      - 示例：`d%` 删除匹配的括号及其内容，`c)` 替换到下一个句子的开头。
      - 场景：使用 `y{` 复制到上一个段落的开头，快速提取文档片段。
    - **与可视模式结合**：
      - 示例：进入可视模式（`v`），使用 `%`、`{` 或 `)` 扩展选择范围。
      - 场景：使用 `v%` 选择匹配的括号及其内容，批量注释代码。
    - **与寄存器结合**：
      - 跳转后使用 `"ayy` 复制当前行到寄存器 `a`。
      - 场景：按 `[{` 跳到上一个 `{`，然后按 `"byy` 复制当前行到寄存器 `b`。
    - **与宏结合**：
      - 示例：录制宏 `qa%dq`，删除匹配的括号及其内容，重复执行以清理多行。
      - 场景：使用宏 `qa)cdq`，替换到下一个句子的开头，批量处理重复模式。
    - **与相对行号结合**：
      - 启用相对行号（`:set relativenumber`），结合 `%` 和 `)` 快速定位。
      - 示例：按 `%` 跳到匹配的括号，相对行号提供上下文参考。
    - **自定义映射**：
      - 在 `.vimrc` 中定义映射，如 `nnoremap <leader>% %`（`<leader>%` 跳转匹配括号）。
      - 示例：`nnoremap <C-)> )`（`Ctrl + )` 跳到下一个句子的开头）。
      - 场景：使用 `nnoremap <leader>{ :execute "normal! {"<CR>`，动态执行跳到上一个段落的开头。
